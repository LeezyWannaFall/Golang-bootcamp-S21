## Команда для запуска:

### macOS:
```bash
cd src
CGO_CFLAGS="-I/usr/local/opt/ncurses/include" CGO_LDFLAGS="-L/usr/local/opt/ncurses/lib -lncurses -lmenu -lform -lpanel" go run ./app
```

### Linux:
```bash
cd src
go run ./app
```

Или с явным указанием библиотек:
```bash
cd src
CGO_LDFLAGS="-lncurses -lmenu -lform -lpanel" go run ./app
```

## Или скомпилировать и запустить:

### macOS:
```bash
cd src
CGO_CFLAGS="-I/usr/local/opt/ncurses/include" CGO_LDFLAGS="-L/usr/local/opt/ncurses/lib -lncurses -lmenu -lform -lpanel" go build -o roguelike ./app
./roguelike
```

### Linux:
```bash
cd src
go build -o roguelike ./app
./roguelike
```


## Управление:
## Если @ не двигается переключиться на английскую раскладку !!!
### Движение:
- **W** / **w** - движение вверх (Forward)
- **S** / **s** - движение вниз (Back)
- **A** / **a** - движение влево (Left)
- **D** / **d** - движение вправо (Right)

### Использование предметов:
- **h** / **H** - использовать оружие (открывает меню выбора)
- **j** / **J** - использовать еду (открывает меню выбора)
- **k** / **K** - использовать эликсир (открывает меню выбора)
- **e** / **E** - использовать свиток (открывает меню выбора)
- **i** / **I** или **b** / **B** - просмотр содержимого рюкзака

### В меню выбора предметов:
- **0-9** - выбор предмета (для оружия: **0** = снять оружие)
- **ESC** - отмена в меню

### Выход из игры:
- **ESC** - выход из игры (с сохранением прогресса)

## Символы на карте:

- `@` - игрок (голубой)
- `z` - зомби (зеленый)
- `v` - вампир (красный)
- `g` - призрак (белый)
- `O` - огр (желтый)
- `s` - змея-маг (белый)
- `m` - мимик (белый) - имитирует предметы, высокая ловкость, низкая сила, высокое здоровье
- `f` - еда (красный)
- `e` - эликсир (цвет зависит от типа: красный/синий/зеленый)
- `S` - свиток (цвет зависит от типа: красный/синий/зеленый)
- `w` - оружие (синий)
- `E` - выход с уровня (желтый)
- `D` - дверь (цвет зависит от цвета ключа: красный/синий/желтый/зеленый)
- `k` - ключ (цвет зависит от типа: красный/синий/желтый/зеленый)
- `|` и `-` - стены
- `.` - пол
- `#` - коридор
- `+` - проем в стене

## Особенности игры:

### Игровая механика:
- **21 уровень подземелья** с процедурной генерацией
- **9 комнат на уровень**, соединенных коридорами
- **Пошаговый режим** - каждый ход игрока запускает действия всех монстров
- **5 типов монстров** с уникальными характеристиками и паттернами движения:
  - **Зомби** (z, зеленый) - низкая ловкость, средняя сила, высокое здоровье
  - **Вампир** (v, красный) - высокая ловкость и враждебность, первый удар всегда промах, снижает максимальное здоровье
  - **Призрак** (g, белый) - высокая ловкость, телепортируется по комнате, низкая враждебность
  - **Огр** (O, желтый) - ходит на 2 клетки за ход, очень высокая сила и здоровье, отдыхает после атаки
  - **Змея-маг** (s, белый) - очень высокая ловкость, ходит по диагонали, может усыпить игрока
  - **Мимик** (m, белый) - имитирует предметы, высокая ловкость и здоровье, низкая сила и враждебность
- **Система боя:** Проверка попадания на основе ловкости, расчет урона на основе силы и оружия
- **Предметы:** Еда (восстанавливает здоровье), эликсиры (временно повышают характеристики), свитки (постоянно повышают характеристики), оружие (увеличивает урон), сокровища (накапливаются для рейтинга)

### Визуализация:
- **Туман войны:** Неизведанные комнаты и коридоры не отображаются. Просмотренные комнаты, но в которых не находится игрок, отображаются только как стены и пол. В комнате, в которой находится игрок, отображаются стены, пол, акторы и предметы. При нахождении в непосредственной близости с комнатой со стороны коридора туман войны рассеивается только на области прямой видимости (применяется алгоритм Ray Casting и алгоритм Брезенхэма для определения видимой области).
- **Цветовая кодировка:** Монстры, предметы и элементы карты имеют различные цвета для лучшей визуальной идентификации

### Взаимодействие:
- **Монстры:** Появляются во всех комнатах КРОМЕ стартовой. Видны только в текущей комнате игрока или в том же проходе. Начинают преследовать игрока при попадании в радиус враждебности
- **Бой:** Начинается автоматически при наступлении на монстра
- **Предметы:** Автоматически подбираются при наступлении на них (если есть место в рюкзаке)
- **Ключи и двери:** Ключи (символ `k`) автоматически подбираются при наступлении. Двери (символ `D`) блокируют проход и открываются автоматически при наличии соответствующего ключа в инвентаре при попытке пройти через них. Система разноцветных ключей (красный, синий, желтый, зеленый) предотвращает софтлоки
- **Выход с уровня:** Отмечен символом `E`. При достижении выхода происходит переход на следующий уровень

### Прогрессия:
- **Сложность:** С каждым уровнем увеличивается количество и сложность монстров, уменьшается количество предметов, увеличивается количество сокровищ с побежденных врагов
- **Система автоматической балансировки:** Игра автоматически подстраивает сложность под уровень игрока. Если игроку легко (быстро проходит уровни, мало использует еду/эликсиры) - увеличивается сложность и количество монстров. Если игроку трудно (много ходов, часто использует еду/эликсиры) - уменьшается сложность, увеличивается количество предметов, особенно еды. Балансировка активируется начиная со 2-го уровня
- **Статистика:** Отслеживается количество сокровищ, достигнутый уровень, побежденные враги, использованные предметы, нанесенные/пропущенные удары, пройденные клетки
- **Сохранение и загрузка игры:**
  - При выходе через **ESC** создается файл `save.json` с текущим прогрессом
  - При следующем запуске появляется **меню выбора**:
    - **New Game** - начать новую игру
    - **Continue Game** - продолжить сохраненную игру (если есть `save.json`)
    - **Scoreboard** - посмотреть таблицу лидеров
    - **Exit** - выйти из игры
  - **Управление в меню:**
    - **W/S** - перемещение по пунктам меню
    - **ENTER** - выбрать пункт
    - **ESC** - выйти из игры
  - После завершения игры (game over или победа) файл `save.json` автоматически удаляется
  - Статистика всех прохождений сохраняется в файл `stats.json`


